<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Writing Annex Stats to Disc — annex_write_stats • annex</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Writing Annex Stats to Disc — annex_write_stats"><meta name="description" content="TODO(R)"><meta property="og:description" content="TODO(R)"><meta property="og:image" content="https://some.example-url.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">annex</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2-14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/config.html">Config files/objects</a></li>
    <li><a class="dropdown-item" href="../articles/from_xlsx.html">Prepare data from XLSX</a></li>
    <li><a class="dropdown-item" href="../articles/from_textfiles.html">Prepare data from textfiles</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_xtra.html">Prepare with time zones &amp; units</a></li>
    <li><a class="dropdown-item" href="../articles/calculate_stats.html">Calculate statistics</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/write_and_validate.html">Write and validate output</a></li>
    <li><a class="dropdown-item" href="../articles/lookupfunctions.html">Lookup functions/definitions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../contact.html">Contact</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IEA-EBC-Annex86/annex/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Writing Annex Stats to Disc</h1>
      <small class="dont-index">Source: <a href="https://github.com/IEA-EBC-Annex86/annex/blob/main/R/write_stats.R" class="external-link"><code>R/write_stats.R</code></a></small>
      <div class="d-none name"><code>annex_write_stats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>TODO(R)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">annex_write_stats</span><span class="op">(</span><span class="va">x</span>, <span class="va">file</span>, <span class="va">user</span>, mode <span class="op">=</span> <span class="st">"write"</span>, <span class="va">...</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object of class <code>annex_stat</code> as returned by
<code><a href="annex_stats.html">annex_stats()</a></code> (wide or long format).</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>name (or path) to the XLSX file where to store
the data. Must end with <code>xlsx</code> (not case sensitive).
See 'Details'.</p></dd>


<dt id="arg-user">user<a class="anchor" aria-label="anchor" href="#arg-user"></a></dt>
<dd><p>positive integer, the user identifier given
by the project team. Will be appended to the data set.</p></dd>


<dt id="arg-mode-">mode, <a class="anchor" aria-label="anchor" href="#arg-mode-"></a></dt>
<dd><p>character, writing mode. Can be one of <code>"write"</code> (default),
<code>"append"</code> (add new data) or <code>"update"</code> (update existing data).
See 'Mode' for more information.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>not yet used.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical. If set <code>TRUE</code> messages will be printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>No return, creates a new XLSX file (see argument <code>file</code>)
and stores the data, or updates an existing XLSX file (see
argument section 'Writing mode').</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is used to write the annex statistics - the final
output - into an XLSX file. The output is based on a template
file shipped with the package with a predefined format.</p>
<p>If the output <code>file</code> does not exist, the template will be copied
and modified by (i) saving the data into the "STAT" sheet as well
as pre-filling some additional meta sheets which have to be
manually edited/entered by the user.</p>
<p>By default, <code>overwrite = FALSE</code>. If the output <code>file</code> already
exists, the function will be terminated. However, it can be set
to <code>TRUE</code> to allow <code>annex_write_stats()</code> to manipulate/overwrite
the current data in that XLSX file. It tries to preserve all
custom data (TODO(R): not yet implemented).</p>
    </div>
    <div class="section level2">
    <h2 id="writing-mode">Writing mode<a class="anchor" aria-label="anchor" href="#writing-mode"></a></h2>
    <p>There are three writing modes. Warning: Depending on
the mode used, existing data can get lost (i.e., removed). The following
modes are available:</p>
<p><strong>write</strong>: Default mode, write data into a fresh XLSX file. It is assumed
that the output <code>file</code> does not yet exist. If it exists an error will
be thrown as it is unkown if the user would like to append new data to
an existing file or update (overwrite) data in an existing file.</p>
<p><strong>append</strong>: Append data to an existing XLSX file. This mode expects that
the <code>file</code> does already exist and is in the correct format (will check
sheets and columns against the template). If <code>file</code> does not exist or
the content of <code>file</code> does not follow the format of the template, an
error will be thrown.</p>
<p><code>mode = "append"</code> falls back to <code>mode = "write"</code> if the output <code>file</code>
does not yet exist.</p>
<p>Else the data of <code>x</code> will be appended to the sheet 'STAT' and additional
entries in the 'META*' sheets will be created if needed. In case the new object <code>x</code>
contains data which are already in <code>STAT</code> an error will be thrown
(so the new data to be appended must be unique).</p>
<p><strong>update</strong>: Update the data of an existing <code>file</code>. <strong>Warning:</strong> this
will delete (drop) existing data in the sheet 'STAT' and append new entries
in the 'META*' sheets (won't delete existing entries). The latter could cause
additional warnings when validating the file if there are 'META*' entries
which are no longer needed (as the data have been deleted).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Reto Stauffer</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Reto Stauffer, Gabriel Rojas-Kopeinig, Tobias Grass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

